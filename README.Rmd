---
output:
  github_document:
    toc: true
    toc_depth: 2
always_allow_html: true
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "50%",
  dpi = 1200
)
```


> ðŸš§ Warning
>
> Il s'agit d'une version de dÃ©veloppement


> ðŸ“˜ Info
>
> Les wrappers d'API sont des outils qui facilitent l'utilisation des fonctionnalitÃ©s offertes par une interface de programmation d'applications (API). Ils simplifient la communication entre une application et une API en gÃ©rant les dÃ©tails techniques et en offrant une interface plus conviviale. Les wrappers d'API permettent aux dÃ©veloppeurs de se concentrer sur la logique de leur application plutÃ´t que sur les aspects techniques de l'intÃ©gration avec l'API. Ils accÃ©lÃ¨rent le dÃ©veloppement et amÃ©liorent la productivitÃ© en rÃ©duisant la quantitÃ© de code nÃ©cessaire.


GrÃ¢ce Ã  `{r.apifoncier}` vous pouvez accÃ©der aux donnÃ©es disponibles par l'[API donnÃ©es fonciÃ¨res du cerema](https://apidf-preprod.cerema.fr/swagger/).


# Installation

Vous pouvez installer r.apifoncier depuis [GitHub](https://github.com/) avec le code suivant :

``` r
# install.packages("devtools")
devtools::install_github("rcadot/r.apifoncier")
```

# Indicateurs de consommation d'espace (accÃ¨s libre)

Les donnÃ©es sont disponibles Ã  deux Ã©chelles : communes et dÃ©partements.

En indiquant le code INSEE d'une commune au format `numeric` ou `character`, on obtient un dataframe des consommations.

```{r}
library(r.apifoncier)

ind_conso_espace_communes(59001)
```

La fonction `g_ind_conso_espace_communes()` permet de gÃ©nÃ©rer un graphique `{plotly}` de la consommation sur la commune de son choix.

```{r}
ind_conso_espace_communes_g(59350)
```


Par dÃ©faut, les consommations sont affichÃ©es en hectares, mais on peut les indiquer en mÂ² en choisissant `hectare=FALSE`.

```{r message=FALSE, warning=FALSE}
ind_conso_espace_communes_g(
  code_insee = 59350,
  hectare = FALSE,
  affichage = 'total',
  legende = FALSE
)
```


# Indicateurs de prix (accÃ¨s libre)

Les indicateurs de prix sont disponibles annuellement et de maniÃ¨re triennale Ã  plusieurs Ã©chelles :

- RÃ©gions ;
- DÃ©partements ;
- Aires d'attractivitÃ©s des villes ;
- EPCI ; 
- Communes.

```{r}
ind_dv3f_com_annuel('59350') %>% 
  dplyr::select(1:10) # Le rÃ©sultat contient 617 colonnes
```

# Cartofriches (accÃ¨s libre)

On peut accÃ©der aux friches, soit par dÃ©partement, commune ou encore Ã  partir d'une emprise au format WGS84

```{r}
cartofriches_friches(coddep = 59,page_size = 3)
```


```{r}
cartofriches_friches(code_insee = 59350,page_size = 3)
```


```{r}
cartofriches_friches(in_bbox = '2.827642,50.495958,3.32616,50.767734',page_size = 2)
```

On peut Ã©galement accÃ©der aux objets gÃ©ographiques associÃ©s.

```{r echo=TRUE, message=FALSE, warning=FALSE}
cartofriches_geofriches(code_insee = 59350,page_size = 10) %>% 
  dplyr::select(geometry) %>% 
  mapview::mapview()
```

